# XLQL (excel SQL)

## Overview

xlql is a command line utility which aims to enable SQL queries and python like language access to data in Excel files. This is done by exporting Excel data from excel files to sqlite database. SQLite SQL can be used against such data. Export to Excel of resulting data is also supported at the moment.

<!--toc-->
- [XLQL (excel SQL)](#xlql-excel-sql)
    * [Overview](#overview)
    * [Installation](#installation)
    * [Basic use](#basic-use)
    * [Examples](#examples)
    * [Command line parameters](#command-line-parameters)
    * [Starlark language](#starlark-language)
    * [SQLite version](#sqlite-version)
    * [API](#api)
    * [Releases](#releases)
    * [Thanks (libraries used)](#thanks-libraries-used)

<!-- tocstop -->

## Installation

Download an executable for your platform from the [releases section](https://github.com/vaal12-go/xlql/releases).

## Basic use

``` xlql.exe -f file_to_execute.star ```

## Examples
Super basic [Example 1](/examples/example.star)
will just load countries sheet from the Sample HR Database.xlsx and print it's content to console. 

> *Run this example from the directory, which has this Sample HR Database.xlsx file.*

[Example 2](/examples/example2.star) shows how to run SQL join on Excel data.
> *Run this example from the directory, which has this Sample HR Database.xlsx file.*

[Example 3](/examples/example3.star) shows hot data generated by starlark script (Taylor approximation for sin function in range [-3 to 4) ) which is exported to Excel. Then in excel graph of the data was done.

![Sin graph](/documentation/img/sine_approximation_data%20and%20graph.png)

[Example 4](/examples/example4.star) shows in memory database creation and iteration via query.get_cursor method.

## Command line parameters
See [command line parameters](command_line_params.md)

## Starlark language

This application is based on excellent [starlark implementation in golang](https://github.com/google/starlark-go/tree/master). 

To quote from the site above
 
> Starlark is a dialect of Python intended for use as a configuration language. 

For complete syntax and specification see [Starlark in Go: Language definition](https://github.com/google/starlark-go/blob/master/doc/spec.md#function-and-method-calls)


## SQLite version
At the moment sqlite version statically linked into executable is **3.42.0** (https://www.sqlite.org/changes.html)
So modern features of sqlite are supported like - RIGHT and FULL OUTER JOIN (2022).
Next release (due June 2024) to be upgraded to latest version of sqlite (as driver (github.com/mattn/go-sqlite3) will allow).


## API
See [API documentation page](/documentation/API.md)

## Releases
See [Releases page](/documentation/releases.md)


## Thanks (libraries used)

* [github.com/jedib0t/go-pretty/v6 v6.4.8](https://github.com/jedib0t/go-pretty/)
* [github.com/joho/godotenv v1.5.1](https://github.com/joho/godotenv)
* [github.com/mattn/go-sqlite3 v1.14.17](https://github.com/mattn/go-sqlite3)
* [github.com/xuri/excelize/v2 v2.8.0](https://github.com/xuri/excelize/v2)
* [go.starlark.net v0.0.0-20231013162135-47c85baa7a64](https://github.com/google/starlark-go)



<!-- SHA: ef3d60e066a01d110a3a17ea4d7b4cf68c638cc91205ac80479751794d17d866 -->









